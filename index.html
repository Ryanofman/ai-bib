        /* Bibliography Content */
        .bibliography-content {
            background: #0a0a0a;
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 2rem;
            font-family: 'Georgia', 'Times New Roman', serif;
            line-height: 2;
            color: #e3e3e3;
        <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Bib</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background-color: #0a0a0a;
            color: #e3e3e3;
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.25rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.25rem;
            font-weight: 500;
            letter-spacing: -0.02em;
            color: #fff;
            text-decoration: none;
            transition: opacity 0.2s;
        }

        .logo:hover {
            opacity: 0.8;
        }

        .nav {
            display: flex;
            gap: 2.5rem;
            align-items: center;
        }

        .nav a {
            color: #b4b4b4;
            text-decoration: none;
            font-size: 0.95rem;
            transition: color 0.2s;
            font-weight: 400;
        }

        .nav a:hover {
            color: #fff;
        }

        .nav-button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 0.5rem 1.25rem;
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.95rem;
            transition: all 0.2s;
            font-weight: 400;
        }

        .nav-button:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        /* Main Container */
        .main-container {
            padding-top: 80px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 4rem 2rem 3rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 3rem;
            font-weight: 600;
            letter-spacing: -0.03em;
            margin-bottom: 1.5rem;
            background: linear-gradient(to right, #fff 20%, #999 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 1.25rem;
            color: #999;
            line-height: 1.7;
            font-weight: 300;
        }

        /* Central Interface */
        .central-interface {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            padding: 0 2rem 4rem;
        }

        /* Upload Methods Section */
        .upload-methods {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
        }

        .upload-methods .method-card:last-child {
            grid-column: 1 / -1;
            max-width: 435px;
            margin: 0 auto;
        }

        .method-card {
            background: #141414;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            user-select: none;
        }

        .method-card * {
            pointer-events: none;
        }

        .method-card:hover {
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .method-card.active {
            border-color: #2563eb;
            background: rgba(37, 99, 235, 0.1);
        }

        .method-icon {
            width: 48px;
            height: 48px;
            margin-bottom: 1rem;
            color: #2563eb;
        }

        .method-icon svg {
            width: 100%;
            height: 100%;
            stroke: currentColor;
            fill: none;
            stroke-width: 1.5;
        }

        .method-title {
            font-size: 1.25rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }

        .method-description {
            color: #999;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .method-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: #2563eb;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* Smart Paste Interface */
        .smart-paste-container {
            background: #141414;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            display: none;
        }

        .smart-paste-container.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .paste-textarea {
            width: 100%;
            min-height: 300px;
            background: #0a0a0a;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1.5rem;
            color: #e3e3e3;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9rem;
            resize: vertical;
            transition: all 0.3s ease;
        }

        .paste-textarea:focus {
            outline: none;
            border-color: #2563eb;
        }

        .format-detector {
            margin-top: 1rem;
            padding: 0.75rem 1rem;
            background: rgba(37, 99, 235, 0.1);
            border-radius: 6px;
            display: none;
            align-items: center;
            gap: 0.5rem;
        }

        .format-detector.active {
            display: flex;
        }

        .detector-icon {
            width: 20px;
            height: 20px;
            color: #2563eb;
        }

        .detector-text {
            font-size: 0.9rem;
            color: #2563eb;
        }

        /* URL Input Interface */
        .url-input-container {
            background: #141414;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            display: none;
        }

        .url-input-container.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .url-input-group {
            display: flex;
            gap: 0.75rem;
        }

        .url-input {
            flex: 1;
            background: #0a0a0a;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 0.875rem 1rem;
            color: #e3e3e3;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .url-input:focus {
            outline: none;
            border-color: #2563eb;
        }

        .url-input::placeholder {
            color: #666;
        }

        .fetch-button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 0.875rem 1.5rem;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .fetch-button:hover {
            background: #1d4ed8;
        }

        .fetch-button:disabled {
            background: #1e1e1e;
            color: #666;
            cursor: not-allowed;
        }

        /* Fetch Status Messages */
        .fetch-status {
            margin-top: 1rem;
            padding: 0.75rem 1rem;
            border-radius: 6px;
            font-size: 0.9rem;
            display: none;
        }

        .fetch-status.success {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #86efac;
        }

        .fetch-status.error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
        }

        .fetch-status.info {
            background: rgba(37, 99, 235, 0.1);
            border: 1px solid rgba(37, 99, 235, 0.3);
            color: #93bbfe;
        }

        /* URL Preview */
        .url-preview {
            background: rgba(37, 99, 235, 0.05);
            border: 1px solid rgba(37, 99, 235, 0.2);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            display: none;
        }

        .url-preview-content h4 {
            color: #60a5fa;
            margin-bottom: 1rem;
            font-size: 1.125rem;
        }

        .preview-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        .preview-stats .stat {
            text-align: center;
        }

        .preview-stats .stat-value {
            display: block;
            font-size: 1.5rem;
            font-weight: 600;
            color: #2563eb;
        }

        .preview-stats .stat-label {
            display: block;
            font-size: 0.75rem;
            color: #999;
            text-transform: uppercase;
            margin-top: 0.25rem;
        }

        .preview-title, .preview-model {
            font-size: 0.875rem;
            color: #999;
            margin: 0.25rem 0;
        }

        /* Platform Examples */
        .platform-examples {
            margin-top: 1rem;
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .platform-chip {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 0.375rem 0.75rem;
            border-radius: 16px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .platform-chip:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        /* Traditional Upload Box */
        .upload-box {
            background: #141414;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
            display: none;
        }

        .upload-box.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .upload-area {
            background: #0a0a0a;
            border: 2px dashed rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .upload-area:hover {
            border-color: rgba(255, 255, 255, 0.3);
            background: #0f0f0f;
        }

        .upload-area.drag-over {
            border-color: #4a9eff;
            background: rgba(74, 158, 255, 0.05);
        }

        .upload-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 1rem;
            opacity: 0.6;
        }

        .upload-icon svg {
            width: 100%;
            height: 100%;
            stroke: currentColor;
            fill: none;
            stroke-width: 1.5;
        }

        .upload-text {
            font-size: 1rem;
            color: #999;
            margin-bottom: 0.5rem;
        }

        .upload-button {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #fff;
            padding: 0.625rem 1.5rem;
            border-radius: 6px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 1rem;
            font-weight: 400;
            pointer-events: auto;
        }

        .upload-button:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .file-input {
            display: none;
        }

        /* File List */
        .file-list {
            margin-top: 1.5rem;
        }

        .file-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.2s;
        }

        .file-item:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .file-icon {
            width: 20px;
            height: 20px;
            opacity: 0.6;
        }

        .file-name {
            font-size: 0.95rem;
            color: #e3e3e3;
        }

        .remove-file {
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            padding: 0.25rem;
            transition: color 0.2s;
            font-size: 1.25rem;
            line-height: 1;
        }

        .remove-file:hover {
            color: #ff4444;
        }

        /* Analysis Preview */
        .analysis-preview {
            background: rgba(37, 99, 235, 0.05);
            border: 1px solid rgba(37, 99, 235, 0.2);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 2rem;
            display: none;
        }

        .analysis-preview.active {
            display: block;
        }

        .analysis-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 600;
            color: #2563eb;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #999;
            margin-top: 0.25rem;
        }

        /* Generate Button */
        .generate-section {
            text-align: center;
            margin-top: 2rem;
        }

        .generate-button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 0.875rem 2.5rem;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .generate-button:hover:not(:disabled) {
            background: #1d4ed8;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
        }

        .generate-button:disabled {
            background: #1e1e1e;
            color: #666;
            cursor: not-allowed;
        }

        /* Loading State */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .loading-content {
            text-align: center;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #2563eb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes highlight {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; box-shadow: 0 0 20px rgba(37, 99, 235, 0.3); }
        }

        .loading-text {
            color: #999;
            font-size: 1rem;
        }

        /* Output Section */
        .output-section {
            background: #141414;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .output-title {
            font-size: 1.5rem;
            font-weight: 500;
            letter-spacing: -0.02em;
        }

        .format-selector {
            display: flex;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            padding: 0.25rem;
        }

        .format-button {
            background: none;
            border: none;
            color: #999;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
            font-weight: 400;
        }

        .format-button.active {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .format-button:hover:not(.active) {
            color: #ccc;
        }

        /* Bibliography Content */
        .bibliography-content {
            background: #0a0a0a;
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 2rem;
            font-family: 'Georgia', 'Times New Roman', serif;
            line-height: 2;
            color: #e3e3e3;
        }

        /* Impact Analysis Styles */
        .impact-warning {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .impact-warning h4 {
            color: #ef4444;
            margin-bottom: 0.5rem;
            font-size: 1.25rem;
        }

        .impact-warning p {
            color: #fca5a5;
            margin-bottom: 0.5rem;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 0.95rem;
        }

        .impact-summary {
            background: rgba(37, 99, 235, 0.05);
            border: 1px solid rgba(37, 99, 235, 0.2);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .impact-summary h4 {
            color: #60a5fa;
            margin-bottom: 1rem;
            font-size: 1.125rem;
        }

        .impact-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1.5rem;
            text-align: center;
        }

        .metric {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 600;
            color: #2563eb;
        }

        .metric-label {
            font-size: 0.875rem;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .citations-section {
            margin-bottom: 2rem;
        }

        .examples-section, .ethical-section {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 6px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .examples-section h5, .ethical-section h5 {
            font-size: 1rem;
            margin-bottom: 0.75rem;
            color: #e3e3e3;
        }

        .examples-section ul, .ethical-section ul {
            list-style: none;
            padding: 0;
        }

        .examples-section li, .ethical-section li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #999;
        }

        .examples-section li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #2563eb;
        }

        .ethical-section li:before {
            content: "!";
            position: absolute;
            left: 0;
            width: 1rem;
            height: 1rem;
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .concern-high {
            color: #fca5a5 !important;
        }

        .concern-medium {
            color: #fde047 !important;
        }

        .concern-low {
            color: #86efac !important;
        }

        .citation-entry {
            margin-bottom: 1.5rem;
            padding-left: 2rem;
            text-indent: -2rem;
            font-size: 0.95rem;
        }

        .citation-entry em {
            font-style: italic;
            color: #ccc;
        }

        /* Action Buttons */
        .output-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .action-button {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #fff;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem;
            font-weight: 400;
        }

        .action-button:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .action-button.primary {
            background: #2563eb;
            border-color: #2563eb;
        }

        .action-button.primary:hover {
            background: #1d4ed8;
            border-color: #1d4ed8;
        }

        /* Features Grid */
        .features {
            max-width: 1200px;
            margin: 6rem auto 4rem;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: #141414;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2.5rem;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .feature-icon {
            width: 48px;
            height: 48px;
            margin-bottom: 1.5rem;
            color: #2563eb;
        }

        .feature-title {
            font-size: 1.25rem;
            font-weight: 500;
            margin-bottom: 0.75rem;
            letter-spacing: -0.02em;
        }

        .feature-description {
            color: #999;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        /* Integrity Report Styles */
        .integrity-report {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .integrity-score {
            text-align: center;
            margin: 1rem 0;
        }

        .integrity-score.high { color: #22c55e; }
        .integrity-score.medium { color: #f59e0b; }
        .integrity-score.low { color: #ef4444; }
        .integrity-score.very_low { color: #dc2626; }

        .score-value {
            font-size: 2.5rem;
            font-weight: 600;
            display: block;
        }

        .score-label {
            font-size: 0.875rem;
            opacity: 0.7;
        }

        .recommendation {
            text-align: center;
            margin: 1rem 0;
            font-style: italic;
            color: #999;
        }

        .issues-section, .warnings-section {
            margin-top: 1rem;
        }

        .issues-section h4, .warnings-section h4 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: #e3e3e3;
        }

        .issue, .warning {
            margin: 0.5rem 0;
            padding-left: 1rem;
            font-size: 0.875rem;
        }

        .issue.high { color: #ef4444; }
        .issue.medium { color: #f59e0b; }
        .warning { color: #fbbf24; }

        /* Footer */
        .footer {
            text-align: center;
            padding: 3rem 2rem;
            color: #666;
            font-size: 0.875rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 6rem;
        }

        /* How It Works Section */
        .how-it-works {
            background: #0f0f0f;
            padding: 6rem 0;
            margin-top: 6rem;
        }

        .section-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
        }

        .section-subtitle {
            font-size: 1.25rem;
            color: #999;
            text-align: center;
            margin-bottom: 4rem;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .process-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 5rem;
        }

        .process-step {
            text-align: center;
            position: relative;
        }

        .step-number {
            width: 60px;
            height: 60px;
            background: #2563eb;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0 auto 1.5rem;
        }

        .process-step h3 {
            font-size: 1.25rem;
            margin-bottom: 0.75rem;
            font-weight: 500;
        }

        .process-step p {
            color: #999;
            line-height: 1.6;
        }

        .completeness-section {
            background: #141414;
            border-radius: 12px;
            padding: 3rem;
            margin-top: 3rem;
        }

        .completeness-section h3 {
            font-size: 1.75rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .check-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .check-item {
            background: #0a0a0a;
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .check-item:hover {
            border-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .check-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .check-item h4 {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .check-item p {
            color: #999;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* About Section */
        .about-section {
            padding: 6rem 0;
            background: #0a0a0a;
        }

        .about-content {
            max-width: 900px;
            margin: 0 auto;
        }

        .mission-statement {
            text-align: center;
            margin-bottom: 4rem;
            padding: 2rem;
            background: #141414;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .mission-statement h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #2563eb;
        }

        .mission-statement p {
            font-size: 1.125rem;
            line-height: 1.8;
            color: #e3e3e3;
        }

        .ideology-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }

        .ideology-card {
            background: #141414;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
            transition: all 0.3s ease;
        }

        .ideology-card:hover {
            border-color: rgba(37, 99, 235, 0.3);
            transform: translateY(-2px);
        }

        .ideology-card h4 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: #fff;
        }

        .ideology-card p {
            color: #999;
            line-height: 1.7;
        }

        .founder-note {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.1) 0%, rgba(37, 99, 235, 0.05) 100%);
            border: 1px solid rgba(37, 99, 235, 0.2);
            border-radius: 12px;
            padding: 3rem;
            margin: 4rem 0;
        }

        .founder-note h3 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .founder-note blockquote {
            font-style: italic;
            font-size: 1.125rem;
            line-height: 1.8;
            color: #e3e3e3;
            margin: 0;
            padding: 0;
            border: none;
        }

        .vision-future {
            background: #141414;
            border-radius: 12px;
            padding: 3rem;
            margin-top: 4rem;
        }

        .vision-future h3 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .vision-future ul {
            list-style: none;
            padding: 0;
            margin: 2rem 0;
        }

        .vision-future li {
            padding-left: 2rem;
            margin-bottom: 1rem;
            position: relative;
            color: #e3e3e3;
            line-height: 1.6;
        }

        .vision-future li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #2563eb;
            font-weight: bold;
        }

        .vision-future > p {
            color: #999;
            line-height: 1.7;
            margin-top: 1.5rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .upload-methods {
                grid-template-columns: 1fr;
            }
            
            .upload-methods .method-card:last-child {
                max-width: 100%;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .features {
                grid-template-columns: 1fr;
            }
            
            .process-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .check-grid {
                grid-template-columns: 1fr;
            }
            
            .ideology-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">AI Bib</a>
            <nav class="nav">
                <a href="#features">Features</a>
                <a href="#how-it-works">How it works</a>
                <a href="#about">About</a>
                <a href="#upload-section" class="nav-button" onclick="scrollToUpload()">Get Started</a>
            </nav>
        </div>
    </header>

    <div class="main-container">
        <section class="hero">
            <h1>Document AI Usage with Academic Integrity</h1>
            <p>Generate professional bibliographies that transparently show how AI enhanced your research and writing process.</p>
        </section>

        <div class="central-interface" id="upload-section">
            <!-- Upload Methods Selection -->
            <div class="upload-methods">
                <div class="method-card" onclick="selectMethod('paste')">
                    <div class="method-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                        </svg>
                    </div>
                    <h3 class="method-title">Smart Paste</h3>
                    <p class="method-description">Copy your entire conversation and paste it here. We'll automatically detect the format and check for completeness.</p>
                </div>

                <div class="method-card" onclick="selectMethod('url')">
                    <div class="method-badge">Recommended</div>
                    <div class="method-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                        </svg>
                    </div>
                    <h3 class="method-title">Share Link</h3>
                    <p class="method-description">Paste a shared conversation link from ChatGPT, Claude, or other AI platforms for the most accurate citations.</p>
                </div>

                <div class="method-card" onclick="selectMethod('file')">
                    <div class="method-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                    </div>
                    <h3 class="method-title">File Upload</h3>
                    <p class="method-description">Upload exported conversation files in JSON, TXT, PDF, or other formats.</p>
                </div>
            </div>

            <!-- Smart Paste Interface -->
            <div class="smart-paste-container" id="pasteContainer">
                <textarea 
                    class="paste-textarea" 
                    id="pasteTextarea"
                    placeholder="Paste your AI conversation here...

Example:
User: Can you help me improve my essay introduction?
Assistant: I'd be happy to help improve your essay introduction..."
                    oninput="detectFormat(this.value)"
                ></textarea>
                
                <div class="format-detector" id="formatDetector">
                    <svg class="detector-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 11l3 3L22 4"/>
                        <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/>
                    </svg>
                    <span class="detector-text" id="detectorText">Detected: ChatGPT conversation</span>
                </div>

                <div class="analysis-preview" id="analysisPreview">
                    <h4 style="margin-bottom: 0.5rem;">Quick Analysis</h4>
                    <div class="analysis-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="messageCount">0</div>
                            <div class="stat-label">Messages</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="codeBlocks">0</div>
                            <div class="stat-label">Code Blocks</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="editCount">0</div>
                            <div class="stat-label">Edits Made</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- URL Input Interface -->
            <div class="url-input-container" id="urlContainer">
                <div class="url-input-group">
                    <input 
                        type="url" 
                        class="url-input" 
                        placeholder="https://chat.openai.com/share/..." 
                        id="urlInput"
                    >
                    <button class="fetch-button" onclick="fetchConversation()">
                        Fetch Conversation
                    </button>
                </div>
                
                <div class="platform-examples">
                    <div class="platform-chip" onclick="setExample('chatgpt')">
                        ChatGPT
                    </div>
                    <div class="platform-chip" onclick="setExample('claude')">
                        Claude
                    </div>
                    <div class="platform-chip" onclick="setExample('gemini')">
                        Gemini
                    </div>
                    <div class="platform-chip" onclick="setExample('perplexity')">
                        Perplexity
                    </div>
                </div>
            </div>

            <!-- Traditional File Upload -->
            <div class="upload-box" id="fileUploadBox">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                    </div>
                    <p class="upload-text">Drop your AI conversation files here</p>
                    <input type="file" id="fileInput" class="file-input" multiple accept=".txt,.json,.pdf,.docx,.csv">
                    <button class="upload-button" onclick="event.stopPropagation(); document.getElementById('fileInput').click()">
                        Choose Files
                    </button>
                </div>
                <div class="file-list" id="fileList"></div>
            </div>

            <div class="generate-section">
                <button class="generate-button" id="generateButton" disabled onclick="generateBibliography()">
                    Generate Bibliography
                </button>
            </div>

            <div class="output-section" id="outputSection">
                <div class="output-header">
                    <h2 class="output-title">Generated Bibliography</h2>
                    <div class="format-selector">
                        <button class="format-button active" onclick="changeFormat('apa')">APA</button>
                        <button class="format-button" onclick="changeFormat('mla')">MLA</button>
                        <button class="format-button" onclick="changeFormat('chicago')">Chicago</button>
                    </div>
                </div>
                <div class="bibliography-content" id="bibliographyContent">
                    <!-- Bibliography entries will be inserted here -->
                </div>
                <div class="output-actions">
                    <button class="action-button primary" onclick="copyBibliography()">
                        Copy to Clipboard
                    </button>
                    <button class="action-button" onclick="downloadBibliography()">
                        Download
                    </button>
                </div>
            </div>
        </div>
    </div>

    <section class="features" id="features">
        <div class="feature-card">
            <div class="feature-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M9 11H3v10h6V11zm5-7H8v17h6V4zm5 11h-6v6h6v-6z"/>
                </svg>
            </div>
            <h3 class="feature-title">Comprehensive Analysis</h3>
            <p class="feature-description">Our AI analyzes your conversations to identify exactly how AI contributed to your work, categorizing assistance by type and impact.</p>
        </div>
        <div class="feature-card">
            <div class="feature-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
            </div>
            <h3 class="feature-title">Academic Standards</h3>
            <p class="feature-description">Generate citations in APA, MLA, and Chicago formats that meet academic requirements for AI source documentation.</p>
        </div>
        <div class="feature-card">
            <div class="feature-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                </svg>
            </div>
            <h3 class="feature-title">Ethical Transparency</h3>
            <p class="feature-description">Promote responsible AI use by clearly documenting how AI enhanced rather than replaced your original thinking and research.</p>
        </div>
    </section>

    <!-- How It Works Section -->
    <section class="how-it-works" id="how-it-works">
        <div class="section-container">
            <h2 class="section-title">How It Works</h2>
            <p class="section-subtitle">Our advanced conversation analysis ensures accurate and complete documentation of AI assistance</p>
            
            <div class="process-grid">
                <div class="process-step">
                    <div class="step-number">1</div>
                    <h3>Upload Your Conversation</h3>
                    <p>Choose from three methods: paste directly, share a link, or upload a file. Our system supports all major AI platforms.</p>
                </div>
                
                <div class="process-step">
                    <div class="step-number">2</div>
                    <h3>Intelligent Analysis</h3>
                    <p>Our detector analyzes conversation structure, identifies usage patterns, and checks for completeness using advanced algorithms.</p>
                </div>
                
                <div class="process-step">
                    <div class="step-number">3</div>
                    <h3>Integrity Verification</h3>
                    <p>We check for missing context, sequence anomalies, and potential edits to ensure your documentation is complete and honest.</p>
                </div>
                
                <div class="process-step">
                    <div class="step-number">4</div>
                    <h3>Generate Citations</h3>
                    <p>Receive properly formatted citations in APA, MLA, or Chicago style that accurately reflect how AI contributed to your work.</p>
                </div>
            </div>

            <div class="completeness-section">
                <h3>How We Check for Completeness</h3>
                <div class="check-grid">
                    <div class="check-item">
                        <div class="check-icon">üîç</div>
                        <h4>Context Analysis</h4>
                        <p>We scan for phrases like "as mentioned earlier" or "continuing from above" that might indicate missing messages.</p>
                    </div>
                    
                    <div class="check-item">
                        <div class="check-icon">üîÑ</div>
                        <h4>Sequence Verification</h4>
                        <p>Conversations should alternate between user and AI. We flag when this pattern is broken, suggesting removed content.</p>
                    </div>
                    
                    <div class="check-item">
                        <div class="check-icon">‚è±Ô∏è</div>
                        <h4>Temporal Consistency</h4>
                        <p>Time references are analyzed to ensure chronological order. Backwards timestamps indicate potential manipulation.</p>
                    </div>
                    
                    <div class="check-item">
                        <div class="check-icon">üìù</div>
                        <h4>Topic Flow</h4>
                        <p>Sudden topic changes or responses without prompts are detected, highlighting possible omissions.</p>
                    </div>
                    
                    <div class="check-item">
                        <div class="check-icon">üíª</div>
                        <h4>Code Completeness</h4>
                        <p>Code blocks with ellipsis or "rest of code" comments suggest incomplete documentation of AI assistance.</p>
                    </div>
                    
                    <div class="check-item">
                        <div class="check-icon">üéØ</div>
                        <h4>Integrity Score</h4>
                        <p>All factors combine into a 0-100% score, with recommendations for how to handle potential issues in citations.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section class="about-section" id="about">
        <div class="section-container">
            <h2 class="section-title">About AI Bib</h2>
            
            <div class="about-content">
                <div class="mission-statement">
                    <h3>Our Mission</h3>
                    <p>AI Bib was created to bridge the gap between innovative AI technology and academic integrity. As AI becomes an integral part of education and research, we believe transparency isn't just ethical‚Äîit's essential for the advancement of knowledge.</p>
                </div>

                <div class="ideology-grid">
                    <div class="ideology-card">
                        <h4>Why This Matters</h4>
                        <p>The rise of AI in academia has created a crisis of trust. Students fear being accused of cheating, while educators struggle to distinguish between AI assistance and original work. This tool transforms that fear into transparency, allowing students to proudly document how AI enhanced their learning journey.</p>
                    </div>
                    
                    <div class="ideology-card">
                        <h4>The Philosophy</h4>
                        <p>We believe AI should amplify human intelligence, not replace it. Just as we cite books and articles, we should cite AI interactions. This isn't about catching cheaters‚Äîit's about celebrating the collaborative nature of modern learning and giving credit where it's due.</p>
                    </div>
                    
                    <div class="ideology-card">
                        <h4>Academic Evolution</h4>
                        <p>Remember when calculators were banned in math class? Now they're required. AI is following the same trajectory. By providing proper documentation tools, we're helping academia evolve to embrace AI as a legitimate research tool rather than a threat.</p>
                    </div>
                    
                    <div class="ideology-card">
                        <h4>Empowering Students</h4>
                        <p>Students shouldn't have to choose between using helpful technology and maintaining academic integrity. AI Bib empowers them to use AI confidently, knowing they can properly document their process and demonstrate their own critical thinking.</p>
                    </div>
                </div>

                <div class="founder-note">
                    <h3>A Note from the Creator</h3>
                    <blockquote>
                        "I built AI Bib because I saw brilliant students paralyzed by fear‚Äîafraid to use AI tools that could enhance their learning, worried about accusations of academic dishonesty. This isn't just a citation generator; it's a movement toward honest, transparent collaboration between humans and AI.
                        <br><br>
                        Every conversation with AI is a learning opportunity. By documenting these interactions, we're not admitting weakness‚Äîwe're demonstrating intellectual curiosity and methodological rigor. The future of education includes AI, and that future should be built on transparency, not suspicion."
                    </blockquote>
                </div>

                <div class="vision-future">
                    <h3>The Future We're Building</h3>
                    <p>Imagine a world where:</p>
                    <ul>
                        <li>Students confidently use AI as a learning partner, fully documenting their process</li>
                        <li>Professors see AI citations as a sign of thorough research, not cheating</li>
                        <li>Academic institutions have clear guidelines for AI use, supported by proper documentation tools</li>
                        <li>The focus shifts from "did you use AI?" to "how did AI enhance your understanding?"</li>
                    </ul>
                    <p>This is the future AI Bib is helping to create‚Äîone citation at a time.</p>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <p>&copy; 2024 AI Bib. Built for academic integrity.</p>
    </footer>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="loading-text">Analyzing your conversations...</p>
        </div>
    </div>

    <script src="conversation-detector.js"></script>
    <script src="ai-impact-analyzer.js"></script>
    <script src="conversation-fetcher.js"></script>
    <script>
        let uploadedFiles = [];
        let currentFormat = 'apa';
        let selectedMethod = null;
        let conversationData = null;
        let detector = null;
        let impactAnalyzer = null;
        let conversationFetcher = null;
        
        // Wait for DOM to load
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize detector if available
            if (window.ConversationDetector) {
                detector = new ConversationDetector();
            }
            // Initialize impact analyzer
            if (window.AIImpactAnalyzer) {
                impactAnalyzer = new AIImpactAnalyzer();
            }
            // Initialize conversation fetcher
            if (window.ConversationFetcher) {
                conversationFetcher = new ConversationFetcher();
            }
        });

        // Method selection
        function selectMethod(method) {
            // Reset all cards
            document.querySelectorAll('.method-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Hide all containers
            document.getElementById('pasteContainer').classList.remove('active');
            document.getElementById('urlContainer').classList.remove('active');
            document.getElementById('fileUploadBox').classList.remove('active');
            
            // Reset button state
            updateGenerateButton();
            
            // Find the clicked card
            const clickedCard = event.currentTarget;
            
            // Activate selected method
            selectedMethod = method;
            clickedCard.classList.add('active');
            
            if (method === 'paste') {
                document.getElementById('pasteContainer').classList.add('active');
                document.getElementById('pasteTextarea').focus();
            } else if (method === 'url') {
                document.getElementById('urlContainer').classList.add('active');
                document.getElementById('urlInput').focus();
            } else if (method === 'file') {
                document.getElementById('fileUploadBox').classList.add('active');
            }
        }

        // Smart format detection
        function detectFormat(text) {
            if (!text || text.length < 50) {
                document.getElementById('formatDetector').classList.remove('active');
                document.getElementById('analysisPreview').classList.remove('active');
                updateGenerateButton();
                return;
            }

            const detector = document.getElementById('formatDetector');
            const detectorText = document.getElementById('detectorText');
            const preview = document.getElementById('analysisPreview');
            
            detector.classList.add('active');
            
            // Use the conversation detector for analysis
            const analysis = detector ? detector.analyzeIntegrity(text) : null;
            
            if (analysis) {
                // Update detector text based on analysis
                if (analysis.format !== 'unknown') {
                    const platformName = analysis.format.charAt(0).toUpperCase() + analysis.format.slice(1);
                    detectorText.textContent = `Detected: ${platformName} conversation (${analysis.score}% integrity)`;
                    
                    // Add warning color if integrity is low
                    if (analysis.integrityLevel === 'low' || analysis.integrityLevel === 'very_low') {
                        detector.style.backgroundColor = 'rgba(239, 68, 68, 0.1)';
                        detectorText.style.color = '#ef4444';
                    } else if (analysis.integrityLevel === 'medium') {
                        detector.style.backgroundColor = 'rgba(245, 158, 11, 0.1)';
                        detectorText.style.color = '#f59e0b';
                    } else {
                        detector.style.backgroundColor = 'rgba(37, 99, 235, 0.1)';
                        detectorText.style.color = '#2563eb';
                    }
                } else {
                    detectorText.textContent = 'Analyzing format...';
                }
                
                // Update stats
                document.getElementById('messageCount').textContent = analysis.statistics.totalMessages || 0;
            } else {
                // Fallback if detector not loaded
                detectorText.textContent = 'Format detected';
                const messageCount = (text.match(/(User:|Human:|Assistant:|You:|ChatGPT:)/g) || []).length;
                document.getElementById('messageCount').textContent = messageCount;
            }
            const codeBlocks = (text.match(/```/g) || []).length / 2;
            document.getElementById('codeBlocks').textContent = Math.floor(codeBlocks);
            const editIndicators = (text.match(/(revised|updated|changed|modified|improved|edited|fixed)/gi) || []).length;
            document.getElementById('editCount').textContent = editIndicators;
            
            preview.classList.add('active');
            
            // Show integrity report if issues found
            if (analysis && analysis.score < 90) {
                const reportHtml = detector.generateReport(analysis);
                const existingReport = document.getElementById('integrityReport');
                
                if (existingReport) {
                    existingReport.innerHTML = reportHtml;
                } else {
                    const reportDiv = document.createElement('div');
                    reportDiv.id = 'integrityReport';
                    reportDiv.innerHTML = reportHtml;
                    preview.appendChild(reportDiv);
                }
            } else {
                const existingReport = document.getElementById('integrityReport');
                if (existingReport) {
                    existingReport.remove();
                }
            }
            
            conversationData = {
                type: 'paste',
                format: analysis ? analysis.format : 'unknown',
                content: text,
                analysis: analysis,
                stats: {
                    messages: analysis ? (analysis.statistics.totalMessages || 0) : 0,
                    codeBlocks: Math.floor(codeBlocks),
                    edits: editIndicators
                }
            };
            
            updateGenerateButton();
        }

        // URL Examples
        function setExample(platform) {
            const urlInput = document.getElementById('urlInput');
            const examples = {
                chatgpt: 'https://chat.openai.com/share/abc123...',
                claude: 'https://claude.ai/share/xyz789...',
                gemini: 'https://g.co/gemini/share/def456...',
                perplexity: 'https://perplexity.ai/share/ghi012...'
            };
            urlInput.value = examples[platform];
            urlInput.focus();
        }

        // Fetch conversation from URL
        async function fetchConversation() {
            const url = document.getElementById('urlInput').value;
            const button = event.target;
            
            if (!url) return;
            
            button.disabled = true;
            button.textContent = 'Fetching...';
            
            try {
                if (conversationFetcher) {
                    // Attempt to fetch the actual conversation
                    const result = await conversationFetcher.fetchConversation(url);
                    
                    if (result.success) {
                        // Process the fetched conversation
                        const conversationText = result.data.text;
                        
                        // Run integrity check
                        const integrityAnalysis = detector ? 
                            detector.analyzeIntegrity(conversationText) : null;
                        
                        // Run impact analysis
                        const impactAnalysis = impactAnalyzer ? 
                            impactAnalyzer.analyzeConversation(conversationText, {
                                format: result.data.platform,
                                metadata: result.data.metadata
                            }) : null;
                        
                        conversationData = {
                            type: 'url',
                            url: url,
                            platform: result.data.platform,
                            content: conversationText,
                            originalData: result.data,
                            integrityAnalysis: integrityAnalysis,
                            impactAnalysis: impactAnalysis
                        };
                        
                        // Show success message
                        showFetchStatus('success', `Successfully fetched ${result.data.messages.length} messages from ${result.data.platform}`);
                        
                        // Update preview
                        updateUrlPreview(result.data, impactAnalysis);
                        
                    } else {
                        // Show error and suggestion
                        showFetchStatus('error', result.error);
                        
                        // Fallback to manual entry
                        if (result.suggestion) {
                            showFetchStatus('info', result.suggestion);
                        }
                    }
                } else {
                    // Fallback if fetcher not loaded
                    showFetchStatus('error', 'Fetcher not available. Please copy and paste your conversation.');
                }
                
            } catch (error) {
                console.error('Fetch error:', error);
                showFetchStatus('error', 'Unable to fetch conversation. Please try copying and pasting instead.');
            } finally {
                button.disabled = false;
                button.textContent = 'Fetch Conversation';
                updateGenerateButton();
            }
        }

        function showFetchStatus(type, message) {
            const statusDiv = document.getElementById('fetchStatus') || createStatusDiv();
            statusDiv.className = `fetch-status ${type}`;
            statusDiv.textContent = message;
            statusDiv.style.display = 'block';
            
            // Auto-hide success messages
            if (type === 'success') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
            }
        }

        function createStatusDiv() {
            const div = document.createElement('div');
            div.id = 'fetchStatus';
            const urlContainer = document.getElementById('urlContainer');
            urlContainer.appendChild(div);
            return div;
        }

        function updateUrlPreview(conversationData, impactAnalysis) {
            const previewDiv = document.getElementById('urlPreview') || createPreviewDiv();
            
            let html = `
                <div class="url-preview-content">
                    <h4>Fetched Conversation</h4>
                    <div class="preview-stats">
                        <div class="stat">
                            <span class="stat-value">${conversationData.messages.length}</span>
                            <span class="stat-label">Messages</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">${conversationData.platform}</span>
                            <span class="stat-label">Platform</span>
                        </div>
            `;
            
            if (impactAnalysis) {
                html += `
                        <div class="stat">
                            <span class="stat-value">${impactAnalysis.impactCategory.percentage}%</span>
                            <span class="stat-label">AI Impact</span>
                        </div>
                `;
            }
            
            html += `
                    </div>
                    <p class="preview-title">Title: ${conversationData.title}</p>
                    <p class="preview-model">Model: ${conversationData.model}</p>
                </div>
            `;
            
            previewDiv.innerHTML = html;
            previewDiv.style.display = 'block';
        }

        function createPreviewDiv() {
            const div = document.createElement('div');
            div.id = 'urlPreview';
            div.className = 'url-preview';
            const urlContainer = document.getElementById('urlContainer');
            urlContainer.appendChild(div);
            return div;
        }

        function detectPlatformFromUrl(url) {
            if (url.includes('chat.openai.com')) return 'chatgpt';
            if (url.includes('claude.ai')) return 'claude';
            if (url.includes('gemini')) return 'gemini';
            if (url.includes('perplexity')) return 'perplexity';
            return 'unknown';
        }

        // Drag and drop functionality
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileList = document.getElementById('fileList');
        const generateButton = document.getElementById('generateButton');

        if (uploadArea) {
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('drag-over');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                handleFiles(e.dataTransfer.files);
            });
        }

        if (fileInput) {
            fileInput.addEventListener('change', (e) => {
                handleFiles(e.target.files);
            });
        }

        function handleFiles(files) {
            for (let file of files) {
                if (!uploadedFiles.find(f => f.name === file.name)) {
                    uploadedFiles.push(file);
                    displayFile(file);
                }
            }
            updateGenerateButton();
        }

        function displayFile(file) {
            const fileItem = document.createElement('div');
            fileItem.className = 'file-item';
            fileItem.innerHTML = `
                <div class="file-info">
                    <svg class="file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    <span class="file-name">${file.name}</span>
                </div>
                <button class="remove-file" onclick="removeFile('${file.name}')">&times;</button>
            `;
            fileList.appendChild(fileItem);
        }

        function removeFile(fileName) {
            uploadedFiles = uploadedFiles.filter(f => f.name !== fileName);
            fileList.innerHTML = '';
            uploadedFiles.forEach(file => displayFile(file));
            updateGenerateButton();
        }

        function updateGenerateButton() {
            const generateButton = document.getElementById('generateButton');
            if (!generateButton) return;
            
            let canGenerate = false;
            
            if (selectedMethod === 'paste') {
                const pasteContent = document.getElementById('pasteTextarea').value;
                canGenerate = pasteContent.length > 50;
            } else if (selectedMethod === 'url') {
                const urlContent = document.getElementById('urlInput').value;
                canGenerate = urlContent.length > 10 && conversationData;
            } else if (selectedMethod === 'file') {
                canGenerate = uploadedFiles.length > 0;
            }
            
            generateButton.disabled = !canGenerate;
        }

        function generateBibliography() {
            document.getElementById('loadingOverlay').style.display = 'flex';
            
            // Simulate processing time
            setTimeout(() => {
                createBibliography();
                document.getElementById('loadingOverlay').style.display = 'none';
                document.getElementById('outputSection').style.display = 'block';
                document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth' });
            }, 2500);
        }

        function createBibliography() {
            const bibliographyContent = document.getElementById('bibliographyContent');
            
            if (!conversationData || !conversationData.content) {
                // Fallback to default entries
                createDefaultBibliography();
                return;
            }

            // Perform comprehensive impact analysis
            const impactAnalysis = impactAnalyzer ? 
                impactAnalyzer.analyzeConversation(conversationData.content, {
                    format: conversationData.format,
                    analysis: conversationData.analysis
                }) : null;

            if (!impactAnalysis) {
                createDefaultBibliography();
                return;
            }

            // Generate dynamic bibliography based on analysis
            let html = '';
            
            // Add warning if AI was primary author
            if (impactAnalysis.impactCategory.warning) {
                html += `<div class="impact-warning">
                    <h4>‚ö†Ô∏è High AI Impact Detected (${impactAnalysis.impactCategory.percentage}%)</h4>
                    <p>${impactAnalysis.impactCategory.description}</p>
                    <p>Please ensure this work reflects your own understanding and critical thinking.</p>
                </div>`;
            }

            // Add impact summary
            html += `<div class="impact-summary">
                <h4>AI Impact Analysis</h4>
                <div class="impact-metrics">
                    <div class="metric">
                        <span class="metric-value">${impactAnalysis.impactCategory.percentage}%</span>
                        <span class="metric-label">Overall Impact</span>
                    </div>
                    <div class="metric">
                        <span class="metric-value">${impactAnalysis.summary.aiGeneratedWords}</span>
                        <span class="metric-label">AI Words</span>
                    </div>
                    <div class="metric">
                        <span class="metric-value">${impactAnalysis.tasks.length}</span>
                        <span class="metric-label">Tasks Completed</span>
                    </div>
                </div>
            </div>`;

            // Generate citations based on recommendations
            html += '<div class="citations-section">';
            
            impactAnalysis.citationRecommendations.forEach((rec, index) => {
                const citation = rec.citation[currentFormat] || rec.citation.apa;
                html += `<div class="citation-entry">
                    ${citation}
                </div>`;
            });

            // Add specific examples if significant
            if (impactAnalysis.specificExamples.length > 0) {
                html += '<div class="examples-section"><h5>Specific AI Contributions:</h5><ul>';
                impactAnalysis.specificExamples.slice(0, 5).forEach(example => {
                    html += `<li>${example.type}: ${example.wordCount} words generated</li>`;
                });
                html += '</ul></div>';
            }

            // Add ethical concerns if any
            if (impactAnalysis.ethicalConcerns.length > 0) {
                html += '<div class="ethical-section"><h5>Important Considerations:</h5><ul>';
                impactAnalysis.ethicalConcerns.forEach(concern => {
                    html += `<li class="concern-${concern.level}">${concern.recommendation}</li>`;
                });
                html += '</ul></div>';
            }

            html += '</div>';

            bibliographyContent.innerHTML = html;
        }

        function createDefaultBibliography() {
            const bibliographyContent = document.getElementById('bibliographyContent');
            
            const entries = [
                {
                    type: 'General Assistance',
                    model: 'AI Assistant',
                    provider: 'Technology Provider',
                    date: new Date().toLocaleDateString(),
                    purpose: 'Research and writing support',
                    impact: 'Collaborative assistance in developing ideas and content'
                }
            ];

            let html = '';
            entries.forEach((entry, index) => {
                html += formatEntry(entry, currentFormat);
            });

            bibliographyContent.innerHTML = html;
        }

        function formatEntry(entry, format) {
            // Handle new format from AIImpactAnalyzer
            if (typeof entry === 'string') {
                return `<div class="citation-entry">${entry}</div>`;
            }
            
            // Legacy format
            let citation = '';
            const integrityNote = entry.integrityNote || '';
            
            switch(format) {
                case 'apa':
                    citation = `<div class="citation-entry">
                        ${entry.provider}. (${entry.date}). <em>${entry.model}: ${entry.type}</em> [Large language model]. Purpose: ${entry.purpose}. Impact: ${entry.impact}${integrityNote}.
                    </div>`;
                    break;
                case 'mla':
                    citation = `<div class="citation-entry">
                        "${entry.type}." <em>${entry.model}</em>, ${entry.provider}, ${entry.date}. Large Language Model. Purpose: ${entry.purpose}. Impact: ${entry.impact}${integrityNote}.
                    </div>`;
                    break;
                case 'chicago':
                    citation = `<div class="citation-entry">
                        ${entry.provider}. "${entry.type}." <em>${entry.model}</em>. Large Language Model. Accessed ${entry.date}. Purpose: ${entry.purpose}. Impact: ${entry.impact}${integrityNote}.
                    </div>`;
                    break;
            }
            
            return citation;
        }

        function changeFormat(format) {
            currentFormat = format;
            document.querySelectorAll('.format-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            createBibliography();
        }

        function copyBibliography() {
            const content = document.getElementById('bibliographyContent').innerText;
            navigator.clipboard.writeText(content).then(() => {
                const button = event.target;
                const originalText = button.innerText;
                button.innerText = 'Copied!';
                setTimeout(() => {
                    button.innerText = originalText;
                }, 2000);
            });
        }

        function downloadBibliography() {
            const content = document.getElementById('bibliographyContent').innerText;
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ai-bibliography-${currentFormat}.txt`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Smooth scroll for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // Scroll to upload section
        function scrollToUpload() {
            event.preventDefault();
            const uploadSection = document.getElementById('upload-section');
            if (uploadSection) {
                uploadSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                // Add a subtle highlight effect
                uploadSection.style.animation = 'highlight 2s ease';
                setTimeout(() => {
                    uploadSection.style.animation = '';
                }, 2000);
            }
        }
    </script>
</body>
</html>